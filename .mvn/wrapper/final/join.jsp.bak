<%@ page contentType="text/html;charset=euc-kr" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>회원가입</title>
</head>
<body>
<%
        if (user.getEmail() == null || user.getPw() == null || user.getName() == null) {
            PrintWriter script = response.getWriter();
            script.println("<script>");
            script.println("alert('입력되지 않은 항목이 있습니다.');");
            script.println("history.back();");
            script.println("</script>");
        } else {
            UserDAO userDAO = new UserDAO();
            int result = userDAO.join(user);

            if (result == -1) {
                PrintWriter script = response.getWriter();
                script.println("<script>");
                script.println("alert('이미 존재하는 이메일입니다.');");
                script.println("history.back();");
                script.println("</script>");
            } else {
                // 회원가입 성공
                session.setAttribute("userEmail", user.getEmail());
                PrintWriter script = response.getWriter();
                script.println("<script>");
                script.println("alert('회원가입에 성공했습니다.');");
                script.println("location.href = '../index.jsp';");
                script.println("</script>");
            }
        }
    %>
    <h2>회원가입</h2>
    <form action="joinAction.jsp" method="post">
        <input type="email" name="email" placeholder="이메일" required><br>
		<input type="id" name="id" placeholder="아이디" required><br>
        <input type="password" name="pw" placeholder="비밀번호" required><br>
        <input type="text" name="name" placeholder="이름" required><br>
        <input type="text" name="nick" placeholder="닉네임"><br>
        <input type="text" name="phone" placeholder="전화번호"><br>
        <input type="text" name="addr" placeholder="주소"><br>
        <input type="submit" value="회원가입">
    </form>
</body>
</html>